<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"thomas-li-sjtu.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Django 框架">
<meta property="og:type" content="article">
<meta property="og:title" content="Django实践(1)">
<meta property="og:url" content="https://thomas-li-sjtu.github.io/2020/12/19/Django%E5%AE%9E%E8%B7%B5_1/index.html">
<meta property="og:site_name" content="More Than Code">
<meta property="og:description" content="Django 框架">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://thomas-li-sjtu.github.io/2020/12/19/Django%E5%AE%9E%E8%B7%B5_1/image-20201219220911177.png">
<meta property="og:image" content="https://thomas-li-sjtu.github.io/2020/12/19/Django%E5%AE%9E%E8%B7%B5_1/image-20201220145346997.png">
<meta property="og:image" content="https://thomas-li-sjtu.github.io/2020/12/19/Django%E5%AE%9E%E8%B7%B5_1/image-20201220150840160.png">
<meta property="article:published_time" content="2020-12-19T09:22:27.000Z">
<meta property="article:modified_time" content="2021-01-02T07:29:49.582Z">
<meta property="article:author" content="Thomas-Li">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Web应用">
<meta property="article:tag" content="可视化">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://thomas-li-sjtu.github.io/2020/12/19/Django%E5%AE%9E%E8%B7%B5_1/image-20201219220911177.png">

<link rel="canonical" href="https://thomas-li-sjtu.github.io/2020/12/19/Django%E5%AE%9E%E8%B7%B5_1/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Django实践(1) | More Than Code</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
    <a target="_blank" rel="noopener" href="https://github.com/thomas-li-sjtu" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">More Than Code</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://thomas-li-sjtu.github.io/2020/12/19/Django%E5%AE%9E%E8%B7%B5_1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Thomas-Li">
      <meta itemprop="description" content="Stay hungry. Stay foolish.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="More Than Code">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Django实践(1)
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-12-19 17:22:27" itemprop="dateCreated datePublished" datetime="2020-12-19T17:22:27+08:00">2020-12-19</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5/" itemprop="url" rel="index"><span itemprop="name">项目实践</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>16k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>14 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>Django 框架</p>
<a id="more"></a>

<h2 id="创建项目："><a href="#创建项目：" class="headerlink" title="创建项目："></a>创建项目：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ django-admin.py startproject test_django</span><br><span class="line">$ <span class="built_in">cd</span> test_django/</span><br><span class="line">$ tree</span><br><span class="line">.</span><br><span class="line">|-- test_django</span><br><span class="line">|   |-- __init__.py</span><br><span class="line">|   |-- asgi.py</span><br><span class="line">|   |-- settings.py</span><br><span class="line">|   |-- urls.py</span><br><span class="line">|   `-- wsgi.py</span><br><span class="line">`-- manage.py</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>test_django:</strong> 项目的容器。</li>
<li><strong>manage.py:</strong> 一个实用的命令行工具，以各种方式与该 Django 项目进行交互。</li>
<li><strong>test_django/<strong>init</strong>.py:</strong> 一个空文件，告诉 Python 该目录是一个 Python 包。</li>
<li><strong>test_django/asgi.py:</strong> 一个 ASGI 兼容的 Web 服务器的入口，以便运行项目。</li>
<li><strong>test_django/settings.py:</strong> 该 Django 项目的设置/配置。</li>
<li><strong>test_django/urls.py:</strong> 该 Django 项目的 URL 声明; 一份由 Django 驱动的网站”目录”。</li>
<li><strong>test_django/wsgi.py:</strong> 一个 WSGI 兼容的 Web 服务器的入口，以便运行项目。</li>
</ul>
<blockquote>
<p>CGI（通用网关接口， Common Gateway Interface）：定义客户端与Web服务器的交流方式。正常情况下客户端发来一个请求，根据<code>HTTP</code>协议服务器解析请求内容，根据内容操作——例如服务器返回一个<code>HTML</code>页面，并且根据<code>HTTP</code>协议构建返回内容的响应格式。涉及到<code>TCP</code>连接、<code>HTTP</code>原始请求和相应格式的工作，由 CGI 完成。</p>
<p>ASGI（异步网关协议接口）：介于网络协议服务和<code>Python</code>应用之间的标准接口，用于解决<code>Python</code>常用的<code>WSGI</code>不支持当前<code>Web</code>开发中的一些新协议标准，是<code>WSGI</code>的扩展。</p>
<p>WSGI（Web服务器网关接口，Python Web Server Gateway Interface）：<code>Python</code>为了解决Web服务器端与客户端之间的通信问题而产生的接口——基于<code>Python</code>的以<code>CGI</code>为标准的一些扩展，支持<code>HTTP</code>协议</p>
</blockquote>
<h2 id="视图和-URL-配置"><a href="#视图和-URL-配置" class="headerlink" title="视图和 URL 配置"></a>视图和 URL 配置</h2><p>新建文件views.py：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ tree</span><br><span class="line">.</span><br><span class="line">|-- test_django</span><br><span class="line">|   |-- __init__.py</span><br><span class="line">|   |-- settings.py</span><br><span class="line">|   |-- urls.py              <span class="comment"># url 配置</span></span><br><span class="line">|   |-- views.py              <span class="comment"># 添加的视图文件</span></span><br><span class="line">|   |-- wsgi.py</span><br><span class="line">`-- manage.py</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">&quot;Hello world ! &quot;</span>)</span><br></pre></td></tr></table></figure>

<p>urls.py中配置url；Django path() 函数：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path(route, <span class="keyword">view</span>, kwargs=<span class="keyword">None</span>, <span class="type">name</span>=<span class="keyword">None</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>route: 字符串，表示 URL 规则，与之匹配的 URL 会执行对应的第二个参数 view。</li>
<li>view: 用于执行与正则表达式匹配的 URL 请求。（来自views的函数）</li>
<li>kwargs: 视图使用的字典类型的参数。</li>
<li>name: 用来反向获取 URL。</li>
</ul>
<h2 id="templates"><a href="#templates" class="headerlink" title="templates"></a>templates</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">test_django/</span><br><span class="line">|-- test_django</span><br><span class="line">|   |-- __init__.py</span><br><span class="line">|   |-- settings.py</span><br><span class="line">|   |-- urls.py</span><br><span class="line">|   |-- views.py</span><br><span class="line">|   |-- wsgi.py</span><br><span class="line">|-- manage.py</span><br><span class="line">|-- templates</span><br><span class="line">    |-- runoob.html</span><br></pre></td></tr></table></figure>

<p>模板是一个html文本，用于分离文档的表现形式和内容。</p>
<p>修改settings.py，将字典<code>TEMPLATES</code>的<code>DIRS</code>键改为 <code>[BASE_DIR, &quot;/templates&quot;,]</code></p>
<p>修改views.py，以向模板提交数据：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">runoob</span>(<span class="params">request</span>):</span></span><br><span class="line">    context          = &#123;&#125;</span><br><span class="line">    context[<span class="string">&#x27;hello&#x27;</span>] = <span class="string">&#x27;Hello World!&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;runoob.html&#x27;</span>, context)</span><br></pre></td></tr></table></figure>

<h3 id="模板语法："><a href="#模板语法：" class="headerlink" title="模板语法："></a>模板语法：</h3><ul>
<li><p>变量：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">view</span>.<span class="keyword">py</span>：｛<span class="string">&quot;HTML变量名&quot;</span> : <span class="string">&quot;views变量名&quot;</span>｝</span><br><span class="line">HTML：｛｛变量名｝｝</span><br></pre></td></tr></table></figure>
</li>
<li><p>列表：</p>
<ul>
<li>html中用 <strong>.</strong> 索引下标取出对应的元素：views_list.0</li>
<li>view： return render(request, “runoob.html”, {“views_list”: views_list})</li>
</ul>
</li>
<li><p>字典：</p>
<ul>
<li>.html中，用 .键 取出对应的值：views_dict.name</li>
<li>view：return render(request, “runoob.html”, {“views_dict”: views_dict})</li>
</ul>
</li>
<li><p>filter：</p>
<ul>
<li>.html中：<code>&#123;&#123; 变量名 | 过滤器：“可选参数” &#125;&#125;</code>，过滤器可以在变量被显示前修改它；一个过滤器的输出又可以作为下一个的输入</li>
</ul>
</li>
<li><p>if：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if condition %&#125;</span><br><span class="line">     ... display</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>for：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for athlete in athlete_list %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;&#123; athlete.name &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% for athlete in athlete_list reversed %&#125;</span><br><span class="line">...</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% for i,j in views_dict.items %&#125;</span><br><span class="line">	&#123;&#123; i &#125;&#125;---&#123;&#123; j &#125;&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>内部通过  变量获取循环序号</p>
<ul>
<li>forloop.counter: 顺序获取循环序号，从 1 开始计算</li>
<li>forloop.counter0: 顺序获取循环序号，从 0 开始计算</li>
<li>forloop.revcounter: 倒叙获取循环序号，结尾序号为 1</li>
<li>forloop.revcounter0: 倒叙获取循环序号，结尾序号为 0</li>
<li>forloop.first（一般配合if标签使用）: 第一条数据返回 True，其他数据返回 False</li>
<li>forloop.last（一般配合if标签使用）: 最后一条数据返回 True，其他数据返回 False</li>
</ul>
</li>
<li><p><code>&#123;% empty %&#125;</code> 从句：在循环为空的时候执行</p>
<figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">for</span></span> i <span class="keyword">in</span> listvar %&#125;</span></span><br><span class="line"><span class="xml">    </span><span class="template-variable">&#123;&#123; forloop.counter0 &#125;&#125;</span></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">empty</span></span> %&#125;</span></span><br><span class="line"><span class="xml">    空空如也～</span></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">endfor</span></span> %&#125;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>ifequal/ifnotequal：</p>
<ul>
<li>比较两个值，相等时，显示在 <code>&#123;% ifequal %&#125;` 和 `&#123;% endifequal %&#125;</code> 之中所有的值</li>
</ul>
</li>
<li><p>Django 注释使用 </p>
</li>
<li><p><code>&#123;% include %&#125;</code>：在模板中包含其它的模板的内容</p>
</li>
<li><p>csrf_token：用于form表单中，跨站请求伪造保护</p>
<ul>
<li>用<code>&#123;% csrf_token %&#125;</code>标签，在 form 表单提交数据时，才会成功</li>
</ul>
</li>
</ul>
<h3 id="自定义标签和过滤器"><a href="#自定义标签和过滤器" class="headerlink" title="自定义标签和过滤器"></a>自定义标签和过滤器</h3><ul>
<li><p>创建 <strong>templatetags</strong> 目录——只能是此名字——并新建.py</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">test_django/</span><br><span class="line">|-- test_django</span><br><span class="line">|   |-- __init__.py</span><br><span class="line">|   |-- __init__.pyc</span><br><span class="line">|   |-- settings.py</span><br><span class="line">...</span><br><span class="line">|-- manage.py</span><br><span class="line">`-- templatetags</span><br><span class="line">`-- templates</span><br><span class="line">|   |-- my_tags.py</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> template</span><br><span class="line"></span><br><span class="line">register = template.Library()   <span class="comment">#必须是register</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>settings.py：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">TEMPLATES = [</span><br><span class="line">    &#123;</span><br><span class="line">        ...</span><br><span class="line">        <span class="string">&#x27;OPTIONS&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;context_processors&#x27;</span>: [...],</span><br><span class="line">            <span class="string">&quot;libraries&quot;</span>:&#123;                          <span class="comment"># 添加这边三行配置</span></span><br><span class="line">                <span class="string">&#x27;my_tags&#x27;</span>:<span class="string">&#x27;templatetags.my_tags&#x27;</span>   <span class="comment"># 添加这边三行配置        </span></span><br><span class="line">            &#125;                                      <span class="comment"># 添加这边三行配置</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>装饰器 @register.simple_tag 自定义标签，装饰器 @register.filter 自定义过滤器（参数最多只能2个）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@register.simple_tag</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_tag1</span>(<span class="params">v1, v2, v3</span>):</span></span><br><span class="line">    <span class="keyword">return</span> v1 * v2 * v3</span><br><span class="line"><span class="meta">@register.filter</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_filter</span>(<span class="params">v1, v2</span>):</span></span><br><span class="line">    <span class="keyword">return</span> v1 * v2</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用自定义标签和过滤器前，要在 html 文件 body 的最上方中导入该 py 文件<code>&#123;% load my_tags %&#125;</code></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% my_tag1 <span class="number">11</span> <span class="number">22</span> <span class="number">33</span> %&#125;</span><br><span class="line">&#123;&#123; <span class="number">11</span>|my_filter:<span class="number">22</span> &#125;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>定义标签时，用上 mark_safe 方法，令标签语义化，相当于 jQuery 中的 html() 方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.utils.safestring <span class="keyword">import</span> mark_safe</span><br><span class="line"><span class="meta">@register.simple_tag</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_html</span>(<span class="params">v1, v2</span>):</span></span><br><span class="line">    temp_html = <span class="string">&quot;&lt;input type=&#x27;text&#x27; id=&#x27;%s&#x27; class=&#x27;%s&#x27; /&gt;&quot;</span> %(v1, v2)</span><br><span class="line">    <span class="keyword">return</span> mark_safe(temp_html)</span><br></pre></td></tr></table></figure>

<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="meta">%</span> my_html <span class="string">&quot;zzz&quot;</span> <span class="string">&quot;xxx&quot;</span> <span class="meta">%</span>&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="静态文件配置"><a href="#静态文件配置" class="headerlink" title="静态文件配置"></a>静态文件配置</h3><ul>
<li><p>创建文件夹statics</p>
</li>
<li><p>settings.py加入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">STATIC_URL = <span class="string">&#x27;/static/&#x27;</span> <span class="comment"># 别名 </span></span><br><span class="line">STATICFILES_DIRS = [ </span><br><span class="line">    os.path.join(BASE_DIR, <span class="string">&quot;statics&quot;</span>), </span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>statics 目录下创建 css 目录，js 目录，images 目录，plugins 目录， 分别放 css文件，js文件，图片，插件</p>
</li>
<li><p>bootstrap 框架放入plugins，HTML 文件的 head 标签中引入 bootstrap</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/static/plugins/bootstrap-3.3.7-dist/css/bootstrap.css&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>模板中加入 <code>&#123;% load static %&#125;</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% load static %&#125;</span><br><span class="line">&#123;&#123;name&#125;&#125;<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &quot;</span><span class="attr">images</span>/<span class="attr">runoob-logo.png</span>&quot; %&#125;&quot; <span class="attr">alt</span>=<span class="string">&quot;runoob-logo&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="模板继承"><a href="#模板继承" class="headerlink" title="模板继承"></a>模板继承</h3><ul>
<li><p>以继承的方式实现复用</p>
</li>
<li><p>父模板（不同的预留区域名字不能相同）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% block 名称 %&#125; </span><br><span class="line">预留给子模板的区域，可以设置设置默认内容</span><br><span class="line">&#123;% endblock 名称 %&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>子模板（假定base.html为父模板路径）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &quot;base.html&quot;%&#125; </span><br><span class="line">&#123; % block 名称 % &#125;</span><br><span class="line">内容 </span><br><span class="line">&#123;% endblock 名称 %&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h2><ul>
<li><p>为数据库提供调用API</p>
</li>
<li><p>Django 使用自带的 ORM——Object Relational Mapping，对象关系映射——代码到python对象到ORM到sql语句到数据库，只能操作到数据表的语法，database要自己率先创建<img src="/2020/12/19/Django%E5%AE%9E%E8%B7%B5_1/image-20201219220911177.png" alt="image-20201219220911177"></p>
</li>
<li><p>settings.py 中修改 DATABASES 配置项</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123; </span><br><span class="line">    <span class="string">&#x27;default&#x27;</span>: </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="string">&#x27;ENGINE&#x27;</span>: <span class="string">&#x27;django.db.backends.mysql&#x27;</span>,    <span class="comment"># 数据库引擎</span></span><br><span class="line">        <span class="string">&#x27;NAME&#x27;</span>: <span class="string">&#x27;runoob&#x27;</span>, <span class="comment"># 数据库名称</span></span><br><span class="line">        <span class="string">&#x27;HOST&#x27;</span>: <span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="comment"># 数据库地址，本机 ip 地址 127.0.0.1 </span></span><br><span class="line">        <span class="string">&#x27;PORT&#x27;</span>: <span class="number">3306</span>, <span class="comment"># 端口 </span></span><br><span class="line">        <span class="string">&#x27;USER&#x27;</span>: <span class="string">&#x27;root&#x27;</span>,  <span class="comment"># 数据库用户名</span></span><br><span class="line">        <span class="string">&#x27;PASSWORD&#x27;</span>: <span class="string">&#x27;123456&#x27;</span>, <span class="comment"># 数据库密码</span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>告诉 Django 使用 pymysql 模块连接 mysql 数据库</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在与 settings.py 同级目录下的 __init__.py 中引入模块和进行配置</span></span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line">pymysql.install_as_MySQLdb()</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="定义模型"><a href="#定义模型" class="headerlink" title="定义模型"></a>定义模型</h3><ul>
<li><p>Django 规定要使用模型，必须创建一个 app</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ django-admin.py startapp TestModel</span><br><span class="line">$ tree</span><br><span class="line">.</span><br><span class="line">test_django</span><br><span class="line">|-- test_django</span><br><span class="line">|-- manage.py</span><br><span class="line">...</span><br><span class="line">|-- TestModel</span><br><span class="line">|   |-- __init__.py</span><br><span class="line">|   |-- admin.py</span><br><span class="line">|   |-- models.py</span><br><span class="line">|   |-- tests.py</span><br><span class="line">|   `-- views.py</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改 models.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># models.py</span></span><br><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span>(<span class="params">models.Model</span>):</span>  <span class="comment"># 类名代表了数据库表名，类的字段代表数据表中的字段（name），数据类型为CharField（相当于varchar）、DateField（相当于datetime），max_length 参数限定长度</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">20</span>)</span><br></pre></td></tr></table></figure>

<p> Django 会自动添加一个 id 作为主键。</p>
</li>
<li><p>settings.py 的 INSTALLED_APPS 添加 <code>TestModel</code></p>
</li>
<li><p>运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ python3 manage.py migrate   <span class="comment"># 创建表结构</span></span><br><span class="line">$ python3 manage.py makemigrations TestModel  <span class="comment"># 让 Django 知道我们在我们的模型有一些变更</span></span><br><span class="line">$ python3 manage.py migrate TestModel   <span class="comment"># 创建表结构</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="数据库操作"><a href="#数据库操作" class="headerlink" title="数据库操作"></a>数据库操作</h3><ul>
<li><p>在 app 目录下新建 testdb.py</p>
</li>
<li><p>在 urls.py 中增加 urlpatterns 元素</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> TestModel <span class="keyword">import</span> testdb</span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;runoob/&#x27;</span>, views.runoob),</span><br><span class="line">    path(<span class="string">&#x27;testdb/&#x27;</span>, testdb.testdb),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加数据：先创建对象，再 save</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> TestModel.models <span class="keyword">import</span> Test</span><br><span class="line"><span class="comment"># 数据库操作</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">testdb</span>(<span class="params">request</span>):</span></span><br><span class="line">    test1 = Test(name=<span class="string">&#x27;runoob&#x27;</span>)</span><br><span class="line">    test1.save()</span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">&quot;&lt;p&gt;数据添加成功！&lt;/p&gt;&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取数据：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">testdb</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="comment"># 初始化</span></span><br><span class="line">    response = <span class="string">&quot;&quot;</span></span><br><span class="line">    response1 = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 通过objects模型管理器的all()获得所有数据行，即SELECT * FROM</span></span><br><span class="line">    <span class="built_in">list</span> = Test.objects.<span class="built_in">all</span>()</span><br><span class="line">    <span class="comment"># filter相当于SQL中的WHERE，可设置条件过滤结果</span></span><br><span class="line">    response2 = Test.objects.<span class="built_in">filter</span>(<span class="built_in">id</span>=<span class="number">1</span>) </span><br><span class="line">    <span class="comment"># 获取单个对象</span></span><br><span class="line">    response3 = Test.objects.get(<span class="built_in">id</span>=<span class="number">1</span>) </span><br><span class="line">    <span class="comment"># 限制返回的数据 相当于 SQL 中的 OFFSET 0 LIMIT 2;</span></span><br><span class="line">    Test.objects.order_by(<span class="string">&#x27;name&#x27;</span>)[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">    <span class="comment">#数据排序</span></span><br><span class="line">    Test.objects.order_by(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">    <span class="comment"># 上面的方法可以连锁使用</span></span><br><span class="line">    Test.objects.<span class="built_in">filter</span>(name=<span class="string">&quot;runoob&quot;</span>).order_by(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">    <span class="comment"># 输出所有数据</span></span><br><span class="line">    <span class="keyword">for</span> var <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">        response1 += var.name + <span class="string">&quot; &quot;</span></span><br><span class="line">    response = response1</span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">&quot;&lt;p&gt;&quot;</span> + response + <span class="string">&quot;&lt;/p&gt;&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新数据：修改数据用 save() 或 update():</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">testdb</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="comment"># 修改其中一个id=1的name字段，再save，相当于SQL中的UPDATE</span></span><br><span class="line">    test1 = Test.objects.get(<span class="built_in">id</span>=<span class="number">1</span>)</span><br><span class="line">    test1.name = <span class="string">&#x27;Google&#x27;</span></span><br><span class="line">    test1.save()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 另外一种方式</span></span><br><span class="line">    <span class="comment">#Test.objects.filter(id=1).update(name=&#x27;Google&#x27;)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 修改所有的列</span></span><br><span class="line">    <span class="comment"># Test.objects.all().update(name=&#x27;Google&#x27;)</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">&quot;&lt;p&gt;修改成功&lt;/p&gt;&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除数据：调用该对象的delete()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">testdb</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="comment"># 删除id=1的数据</span></span><br><span class="line">    test1 = Test.objects.get(<span class="built_in">id</span>=<span class="number">1</span>)</span><br><span class="line">    test1.delete()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 另外一种方式</span></span><br><span class="line">    <span class="comment"># Test.objects.filter(id=1).delete()</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 删除所有数据</span></span><br><span class="line">    <span class="comment"># Test.objects.all().delete()</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">&quot;&lt;p&gt;删除成功&lt;/p&gt;&quot;</span>)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="表单"><a href="#表单" class="headerlink" title="表单"></a>表单</h2><ul>
<li><p>Get：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 表单</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">search_form</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;search_form.html&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 接收请求数据</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">search</span>(<span class="params">request</span>):</span>  </span><br><span class="line">    request.encoding=<span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;q&#x27;</span> <span class="keyword">in</span> request.GET <span class="keyword">and</span> request.GET[<span class="string">&#x27;q&#x27;</span>]:</span><br><span class="line">        message = <span class="string">&#x27;你搜索的内容为: &#x27;</span> + request.GET[<span class="string">&#x27;q&#x27;</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        message = <span class="string">&#x27;你提交了空表单&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(message)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Post：POST 方法提交的表格，必须有<code>&#123;% csrf_token %&#125;</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.views.decorators <span class="keyword">import</span> csrf</span><br><span class="line"><span class="comment"># 接收POST请求数据</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">search_post</span>(<span class="params">request</span>):</span></span><br><span class="line">    ctx =&#123;&#125;</span><br><span class="line">    <span class="keyword">if</span> request.POST:</span><br><span class="line">        ctx[<span class="string">&#x27;rlt&#x27;</span>] = request.POST[<span class="string">&#x27;q&#x27;</span>]</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;post.html&quot;</span>, ctx)</span><br></pre></td></tr></table></figure>
</li>
<li><p>每个视图函数的第一个参数是 HttpRequest 对象（request 对象）</p>
<ul>
<li> GET和POST属性是django.http.QueryDict类的实例</li>
<li>类似字典的自定义类，处理单键对应多值的情况<ul>
<li>**get()**：返回字符串，取出该键的最后一个值</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="视图views"><a href="#视图views" class="headerlink" title="视图views"></a>视图views</h2><ul>
<li>views.py</li>
<li>request 对象<ul>
<li>request.path：获取 URL 中的路径部分</li>
<li>request.body</li>
<li>request.method：获取当前请求的方式（post/get）</li>
</ul>
</li>
<li>httpresponse 对象<ul>
<li>HttpResponse()：返回文本，参数为字符串，字符串中写文本内容</li>
<li>render()：返回文本，第一个参数为 request，第二个参数为字符串（页面名称），第三个参数为字典（可选参数，向页面传递的参数）——<code>render(request,&quot;runoob.html&quot;,&#123;&quot;name&quot;:name&#125;)</code>——一般用于页面跳转</li>
<li>redirect()：重定向，跳转新页面；一般用于 form 表单提交后，跳转到新页面——<code>redirect(&quot;/index/&quot;)</code></li>
</ul>
</li>
</ul>
<h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><ul>
<li><p>urls.py</p>
</li>
<li><p>根据用户请求的 URL 链接来判断对应的处理程序，返回处理结果——URL 与 Django 的视图建立映射关系</p>
</li>
<li><p>普通路径：path()；正则路径：re_path()</p>
</li>
<li><p>路由分发：</p>
<ul>
<li><p>Django 项目里多个app目录共用一个 urls 容易造成混淆——使用路由分发（include），让每个app目录都单独拥有自己的 urls</p>
</li>
<li><p>每个 app 目录里都创建一个 urls.py 文件</p>
</li>
<li><p>项目名称目录下的 urls 文件里，统一将路径分发给各个 app 目录</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;admin/&#x27;</span>, admin.site.urls),</span><br><span class="line">    path(<span class="string">&quot;app01/&quot;</span>, include(<span class="string">&quot;app01.urls&quot;</span>)),</span><br><span class="line">    path(<span class="string">&quot;app02/&quot;</span>, include(<span class="string">&quot;app02.urls&quot;</span>)),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>反向解析</p>
</li>
<li><p>命名空间</p>
</li>
</ul>
<h2 id="Admin管理"><a href="#Admin管理" class="headerlink" title="Admin管理"></a>Admin管理</h2><ul>
<li><p>自动管理工具已在  INSTALLED_APPS 、urls.py 配置好</p>
</li>
<li><p>通过命令<code>python manage.py createsuperuser</code>来创建超级用户</p>
</li>
<li><p>admin 界面管理某个数据模型</p>
<ul>
<li><p>admin.py：Test为Model类</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># <span class="selector-tag">Register</span> <span class="selector-tag">your</span> <span class="selector-tag">models</span> <span class="selector-tag">here</span>.</span><br><span class="line"><span class="selector-tag">admin</span><span class="selector-class">.site</span><span class="selector-class">.register</span>(<span class="selector-tag">Test</span>)</span><br><span class="line"># <span class="selector-tag">admin</span><span class="selector-class">.site</span><span class="selector-class">.register</span>(<span class="selector-attr">[Test, Contact, Tag]</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/2020/12/19/Django%E5%AE%9E%E8%B7%B5_1/image-20201220145346997.png" alt="image-20201220145346997"></p>
</li>
<li><p>修改某一个界面：在表Contact的添加里限定添加的字段、搜索</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Register your models here.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ContactAdmin</span>(<span class="params">admin.ModelAdmin</span>):</span></span><br><span class="line">    list_display = (<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;email&#x27;</span>) <span class="comment"># list</span></span><br><span class="line">    search_fields = (<span class="string">&#x27;name&#x27;</span>,)  <span class="comment"># 搜索框</span></span><br><span class="line">    inlines = [TagInline]  <span class="comment"># Inline  让表 Tag 附加在 Contact 的编辑页面上显示</span></span><br><span class="line">    fieldsets = (</span><br><span class="line">        [<span class="string">&#x27;Main&#x27;</span>,&#123;</span><br><span class="line">            <span class="string">&#x27;fields&#x27;</span>:(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;email&#x27;</span>),</span><br><span class="line">        &#125;],</span><br><span class="line">        [<span class="string">&#x27;Advance&#x27;</span>,&#123;</span><br><span class="line">            <span class="string">&#x27;classes&#x27;</span>: (<span class="string">&#x27;collapse&#x27;</span>,),  <span class="comment"># classes 说明它所在的部分的 CSS 格式</span></span><br><span class="line">            <span class="string">&#x27;fields&#x27;</span>: (<span class="string">&#x27;age&#x27;</span>,),</span><br><span class="line">        &#125;]  <span class="comment"># 将输入栏分块</span></span><br><span class="line"> </span><br><span class="line">    )</span><br><span class="line"> </span><br><span class="line">admin.site.register(Contact, ContactAdmin)</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<p><img src="/2020/12/19/Django%E5%AE%9E%E8%B7%B5_1/image-20201220150840160.png" alt="image-20201220150840160"></p>
<h2 id="表的实例"><a href="#表的实例" class="headerlink" title="表的实例"></a>表的实例</h2><h3 id="单个表"><a href="#单个表" class="headerlink" title="单个表"></a>单个表</h3><ul>
<li><p>models.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Book</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    <span class="built_in">id</span> = models.AutoField(primary_key=<span class="literal">True</span>) <span class="comment"># id 会自动创建,可以手动写入</span></span><br><span class="line">    title = models.CharField(max_length=<span class="number">32</span>) <span class="comment"># 书籍名称</span></span><br><span class="line">    price = models.DecimalField(max_digits=<span class="number">5</span>, decimal_places=<span class="number">2</span>) <span class="comment"># 书籍价格</span></span><br><span class="line">    publish = models.CharField(max_length=<span class="number">32</span>) <span class="comment"># 出版社名称</span></span><br><span class="line">    pub_date = models.DateField() <span class="comment"># 出版时间</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>views.py：</p>
<ul>
<li><p><code>books = models.Book.objects.filter(pk=5)</code>，pk为primary key</p>
</li>
<li><p><strong>exclude()</strong> ：用于查询不符合条件的数据</p>
</li>
<li><p><strong>get()</strong> ：符合条件的对象只能为一个，如果符合筛选条件的对象超过了一个或者没有都会报错</p>
</li>
<li><p><strong>order_by()</strong> ：对查询结果进行排序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">books = models.Book.objects.order_by(<span class="string">&quot;price&quot;</span>) <span class="comment"># 查询所有，按照价格升序排列 </span></span><br><span class="line">books = models.Book.objects.order_by(<span class="string">&quot;-price&quot;</span>) <span class="comment"># 查询所有，按照价格降序排列</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>count()</strong> ：查询数据的数量</p>
</li>
<li><p><strong>first()</strong> ：返回第一条数据</p>
</li>
<li><p>**last()**：返回最后一条数据</p>
</li>
<li><p><strong>exists()</strong> ：判断的数据类型只能为 QuerySet 类型数据，返回 true 和 false</p>
</li>
<li><p><strong>values()</strong> ：用于查询部分字段的数据，返回一个可迭代的字典序列，字典里的键是字段，值是数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_book</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="comment"># 查询所有的id字段和price字段的数据</span></span><br><span class="line">    books = models.Book.objects.values(<span class="string">&quot;pk&quot;</span>,<span class="string">&quot;price&quot;</span>)</span><br><span class="line">    print(books[<span class="number">0</span>][<span class="string">&quot;price&quot;</span>],<span class="built_in">type</span>(books)) <span class="comment"># 得到的是第一条记录的price字段的数据</span></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">&quot;&lt;p&gt;查找成功！&lt;/p&gt;&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>**values_list()**：返回元组，只有数据</p>
</li>
<li><p>**distinct()**：对数据去重</p>
</li>
<li><p><strong>filter()</strong> ：基于双下划线的模糊查询（exclude 同理）。filter 中运算符号只能使用=</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_book</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="comment"># 查询价格为200或者300的数据</span></span><br><span class="line">    books = models.Book.objects.<span class="built_in">filter</span>(price__in=[<span class="number">200</span>,<span class="number">300</span>])</span><br><span class="line">    <span class="comment"># 查询价格大于200的数据 </span></span><br><span class="line">	books = models.Book.objects.<span class="built_in">filter</span>(price__gt=<span class="number">200</span>)</span><br><span class="line">    <span class="comment"># 查询价格大于等于200的数据 </span></span><br><span class="line">    books = models.Book.objects.<span class="built_in">filter</span>(price__gte=<span class="number">200</span>)</span><br><span class="line">    <span class="comment"># 查询价格小于300的数据 </span></span><br><span class="line">	books = models.Book.objects.<span class="built_in">filter</span>(price__lt=<span class="number">300</span>)</span><br><span class="line">    <span class="comment"># 查询价格小于等于300的数据 </span></span><br><span class="line">	books = models.Book.objects.<span class="built_in">filter</span>(price__lte=<span class="number">300</span>)</span><br><span class="line">    <span class="comment"># 在。。。之间，左闭右闭</span></span><br><span class="line">	books = models.Book.objects.<span class="built_in">filter</span>(price__range=[<span class="number">200</span>,<span class="number">300</span>])</span><br><span class="line">    <span class="comment"># 包含</span></span><br><span class="line">	books =	models.Book.objects.<span class="built_in">filter</span>(title__contains=<span class="string">&quot;菜&quot;</span>)</span><br><span class="line">    <span class="comment"># 不区分大小写的包含</span></span><br><span class="line">    books = models.Book.objects.<span class="built_in">filter</span>(title__icontains=<span class="string">&quot;python&quot;</span>) </span><br><span class="line">    <span class="comment"># 以指定字符开头</span></span><br><span class="line">    books = models.Book.objects.<span class="built_in">filter</span>(title__startswith=<span class="string">&quot;菜&quot;</span>)</span><br><span class="line">    books = models.Book.objects.<span class="built_in">filter</span>(title__endswith=<span class="string">&quot;教程&quot;</span>)</span><br><span class="line">    <span class="comment"># DateField 数据类型的年份、月份、天</span></span><br><span class="line">    books = models.Book.objects.<span class="built_in">filter</span>(pub_date__year=<span class="number">2008</span>) </span><br><span class="line">    books = models.Book.objects.<span class="built_in">filter</span>(pub_date__month=<span class="number">10</span>) </span><br><span class="line">    books = models.Book.objects.<span class="built_in">filter</span>(pub_date__day=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">&quot;&lt;p&gt;查找成功！&lt;/p&gt;&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>QuerySet 类型数据.update(字段名=更改的数据)，返回值：整数，受影响的行数  /  模型类的对象.属性 = 更改的属性值，模型类的对象.save()</p>
</li>
</ul>
</li>
</ul>
<h3 id="多个表"><a href="#多个表" class="headerlink" title="多个表"></a>多个表</h3><ul>
<li><p>models.py：模型类存在外键，创建数据时，要先创建外键关联的模型类的数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Book</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    title = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    price = models.DecimalField(max_digits=<span class="number">5</span>, decimal_places=<span class="number">2</span>)</span><br><span class="line">    pub_date = models.DateField()</span><br><span class="line">    publish = models.ForeignKey(<span class="string">&quot;Publish&quot;</span>, on_delete=models.CASCADE)  <span class="comment"># 外键在一对多的多中设置</span></span><br><span class="line">    authors = models.ManyToManyField(<span class="string">&quot;Author&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Publish</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    city = models.CharField(max_length=<span class="number">64</span>)</span><br><span class="line">    email = models.EmailField()  <span class="comment"># EmailField 数据类型是邮箱格式, 继承 CharField</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Author</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    age = models.SmallIntegerField()</span><br><span class="line">    au_detail = models.OneToOneField(<span class="string">&quot;AuthorDetail&quot;</span>, on_delete=models.CASCADE)  <span class="comment"># OneToOneField = ForeignKey(...，unique=True)设置一对一</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AuthorDetail</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    gender_choices = (</span><br><span class="line">        (<span class="number">0</span>, <span class="string">&quot;女&quot;</span>),</span><br><span class="line">        (<span class="number">1</span>, <span class="string">&quot;男&quot;</span>),</span><br><span class="line">        (<span class="number">2</span>, <span class="string">&quot;保密&quot;</span>),</span><br><span class="line">    )</span><br><span class="line">    gender = models.SmallIntegerField(choices=gender_choices)</span><br><span class="line">    tel = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    addr = models.CharField(max_length=<span class="number">64</span>)</span><br><span class="line">    birthday = models.DateField()</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加数据</p>
<ul>
<li><p>一对多</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_book</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="comment">#  获取出版社对象</span></span><br><span class="line">    pub_obj = models.Publish.objects.<span class="built_in">filter</span>(pk=<span class="number">1</span>).first()</span><br><span class="line">    <span class="comment">#  获取出版社对象的id</span></span><br><span class="line">    pk = pub_obj.pk</span><br><span class="line">    <span class="comment">#  给书籍的关联出版社字段 publish_id 传出版社对象的id</span></span><br><span class="line">    book = models.Book.objects.create(title=<span class="string">&quot;冲灵剑法&quot;</span>, price=<span class="number">100</span>, pub_date=<span class="string">&quot;2004-04-04&quot;</span>, publish_id=pk)</span><br><span class="line">    print(book, <span class="built_in">type</span>(book))</span><br><span class="line">    <span class="keyword">return</span> HttpResponse(book)</span><br></pre></td></tr></table></figure>
</li>
<li><p>多对多</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_book</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="comment">#  获取作者对象</span></span><br><span class="line">    chong = models.Author.objects.<span class="built_in">filter</span>(name=<span class="string">&quot;令狐冲&quot;</span>).first()</span><br><span class="line">    <span class="comment">#  获取作者对象的id</span></span><br><span class="line">    pk = chong.pk</span><br><span class="line">    <span class="comment">#  获取书籍对象</span></span><br><span class="line">    book = models.Book.objects.<span class="built_in">filter</span>(title=<span class="string">&quot;冲灵剑法&quot;</span>).first()</span><br><span class="line">    <span class="comment">#  给书籍对象的 authors 属性用 add 方法传作者对象的id</span></span><br><span class="line">    book.authors.add(pk)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>查询</p>
<ul>
<li><p>基于对象的跨表查询</p>
<ul>
<li><p>正向：属性名称   反向：小写类名_set</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询主键为 1 的书籍的出版社所在的城市（正向）</span></span><br><span class="line">res = models.Book.objects.<span class="built_in">filter</span>(pk=<span class="number">10</span>).first().publish.city  </span><br><span class="line"><span class="comment"># 查询明教出版社出版的书籍名（反向）</span></span><br><span class="line">pub = models.Publish.objects.<span class="built_in">filter</span>(name=<span class="string">&quot;明教出版社&quot;</span>).first().book_set.<span class="built_in">all</span>()</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>基于双下划线的跨表查询</p>
<ul>
<li><p>正向：属性名称__ 跨表的属性名称   反向：小写类名__跨表的属性名称</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询菜鸟出版社出版过的所有书籍的名字与价格</span></span><br><span class="line">res = models.Book.objects.<span class="built_in">filter</span>(publish__name=<span class="string">&quot;菜鸟出版社&quot;</span>).values_list(<span class="string">&quot;title&quot;</span>, <span class="string">&quot;price&quot;</span>)</span><br><span class="line">res = models.Publish.objects.<span class="built_in">filter</span>(name=<span class="string">&quot;菜鸟出版社&quot;</span>).values_list(<span class="string">&quot;book__title&quot;</span>,<span class="string">&quot;book__price&quot;</span>)</span><br><span class="line"><span class="comment"># 查询任我行出过的所有书籍的名字</span></span><br><span class="line">res = models.Book.objects.<span class="built_in">filter</span>(authors__name=<span class="string">&quot;任我行&quot;</span>).values_list(<span class="string">&quot;title&quot;</span>)</span><br><span class="line">res = models.Author.objects.<span class="built_in">filter</span>(name=<span class="string">&quot;任我行&quot;</span>).values_list(<span class="string">&quot;book__title&quot;</span>)</span><br></pre></td></tr></table></figure>


</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="用户认证（Auth）组件"><a href="#用户认证（Auth）组件" class="headerlink" title="用户认证（Auth）组件"></a>用户认证（Auth）组件</h2><ul>
<li><p>一般用在用户的登录注册上，用于判断当前的用户是否合法，并跳转到登陆成功或失败页面</p>
</li>
<li><p>模块：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 认证模块</span></span><br><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> auth</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对应数据库</span></span><br><span class="line"><span class="keyword">from</span> django.contrib.auth.models <span class="keyword">import</span> User</span><br></pre></td></tr></table></figure>
</li>
<li><p>用户创建：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib.auth.models <span class="keyword">import</span> User </span><br><span class="line">User.objects.create(username=<span class="string">&#x27;runboo&#x27;</span>,password=<span class="string">&#x27;123&#x27;</span>)  <span class="comment"># 创建一个普通用户，密码是明文的</span></span><br><span class="line">User.objects.create_user(username=<span class="string">&#x27;runbooo&#x27;</span>,password=<span class="string">&#x27;123&#x27;</span>)  <span class="comment"># 创建一个普通用户，密码是密文的</span></span><br><span class="line">User.objects.create_superuser(username=<span class="string">&#x27;runboooo&#x27;</span>,password=<span class="string">&#x27;123&#x27;</span>,email=<span class="string">&#x27;runboo@163.com&#x27;</span>)  <span class="comment"># 创建一个超级用户，密码是密文的，要多传一个邮箱 email 参数</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>views.py.login()</p>
<ul>
<li><p>验证用户的用户名和密码使用 authenticate() </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;GET&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">&quot;login.html&quot;</span>)</span><br><span class="line">    username = request.POST.get(<span class="string">&quot;username&quot;</span>)</span><br><span class="line">    password = request.POST.get(<span class="string">&quot;pwd&quot;</span>)</span><br><span class="line">    valid_num = request.POST.get(<span class="string">&quot;valid_num&quot;</span>)</span><br><span class="line">    keep_str = request.session.get(<span class="string">&quot;keep_str&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> keep_str.upper() == valid_num.upper():</span><br><span class="line">        user_obj = auth.authenticate(username=username, password=password)</span><br><span class="line">        print(user_obj.username)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> user_obj:</span><br><span class="line">            <span class="keyword">return</span> redirect(<span class="string">&quot;/login/&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            auth.login(request, user_obj)</span><br><span class="line">            path = request.GET.get(<span class="string">&quot;next&quot;</span>) <span class="keyword">or</span> <span class="string">&quot;/index/&quot;</span></span><br><span class="line">            print(path)</span><br><span class="line">            <span class="keyword">return</span> redirect(path)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&quot;/login/&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>验证成功返回用户对象，反之，返回 None</p>
</li>
</ul>
</li>
<li><p>views.py.logout()</p>
<ul>
<li><p>注销用户，清空 session 信息，将 request.user 赋值为匿名用户</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">logout</span>(<span class="params">request</span>):</span></span><br><span class="line">    ppp = auth.logout(request)</span><br><span class="line">    print(ppp) <span class="comment"># None</span></span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&quot;/login/&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>给需要登录成功后才能访问的页面统一加装饰器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib.auth.decorators <span class="keyword">import</span> login_required </span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>(<span class="params">request</span>):</span></span><br><span class="line">  <span class="keyword">return</span> HttpResponse(<span class="string">&quot;index页面。。。&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>返回登录前的页面</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果直接输入 login、get() 就取不到值，path 可以自定义设置返回的页面</span></span><br><span class="line">path = request.GET.get(<span class="string">&quot;next&quot;</span>) <span class="keyword">or</span> <span class="string">&quot;/index/&quot;</span></span><br><span class="line"><span class="keyword">return</span> redirect(path)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a target="_blank" rel="noopener" href="https://www.runoob.com/django">菜鸟教程 Django</a></p>

    </div>

    
    
    
      
  <div class="popular-posts-header">相关文章推荐</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2020\12\30\FlaskWeb开发-1\" rel="bookmark">FlaskWeb开发（1）Flask介绍</a></div>
        <div class="popular-posts-excerpt"><p><p>《FlaskWeb开发》阅读笔记</p>
<p>第一部分 Flask简介</p></p></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2021\01\03\FlaskWeb开发-2\" rel="bookmark">FlaskWeb开发（2）Flask实例</a></div>
        <div class="popular-posts-excerpt"><p><p>《FlaskWeb开发》阅读笔记</p>
<p>第二部分 Flask实例：社交博客 —— 用户认证、角色分配与资料编辑</p></p></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2021\01\06\FlaskWeb开发-3\" rel="bookmark">FlaskWeb开发（3）Flask实例</a></div>
        <div class="popular-posts-excerpt"><p><p>《FlaskWeb开发》阅读笔记</p>
<p>第二部分 Flask实例：社交博客 —— 博客引擎、关注和评论</p></p></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2020\11\04\Python编程：从入门到实践（3）项目实践——Django\" rel="bookmark">《Python编程：从入门到实践》 （3）Django</a></div>
        <div class="popular-posts-excerpt"><p><p>《Python编程 从入门到实践》第二部分阅读笔记：Django</p></p></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2020\11\04\Python编程：从入门到实践（2）项目实践——可视化\" rel="bookmark">《Python编程：从入门到实践》 （2）可视化</a></div>
        <div class="popular-posts-excerpt"><p><p>《Python编程 从入门到实践》第二部分阅读笔记：可视化</p></p></div>
    </li>
  </ul>

        <div class="reward-container">
  <div></div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.png" alt="Thomas-Li 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.png" alt="Thomas-Li 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Thomas-Li
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://thomas-li-sjtu.github.io/2020/12/19/Django%E5%AE%9E%E8%B7%B5_1/" title="Django实践(1)">https://thomas-li-sjtu.github.io/2020/12/19/Django实践_1/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <div>
      
        
      
      </div>

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Python/" rel="tag"><i class="fa fa-tag"></i> Python</a>
              <a href="/tags/Web%E5%BA%94%E7%94%A8/" rel="tag"><i class="fa fa-tag"></i> Web应用</a>
              <a href="/tags/%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag"><i class="fa fa-tag"></i> 可视化</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/12/19/%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E5%AD%A6%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE/" rel="prev" title="现代密码学 mmtls">
      <i class="fa fa-chevron-left"></i> 现代密码学 mmtls
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/12/20/MongoDB_1/" rel="next" title="MongoDB(1)">
      MongoDB(1) <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
      <!-- require APlayer -->
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css">
      <script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script>
      <!-- require MetingJS-->
      <script src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"></script> 
      <!--������-->   
      <meting-js
        server="netease"
        id="2655164600"
        type="playlist" 
        mini="false"
        fixed="false"
        list-folded="true"
        autoplay="false"
        volume="0.4"
        theme="#FADFA3"
        order="random"
        loop="all"
        preload="auto"
        mutex="true">
      </meting-js>

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>
      
      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE%EF%BC%9A"><span class="nav-number">1.</span> <span class="nav-text">创建项目：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE%E5%92%8C-URL-%E9%85%8D%E7%BD%AE"><span class="nav-number">2.</span> <span class="nav-text">视图和 URL 配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#templates"><span class="nav-number">3.</span> <span class="nav-text">templates</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E8%AF%AD%E6%B3%95%EF%BC%9A"><span class="nav-number">3.1.</span> <span class="nav-text">模板语法：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%87%E7%AD%BE%E5%92%8C%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="nav-number">3.2.</span> <span class="nav-text">自定义标签和过滤器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE"><span class="nav-number">3.3.</span> <span class="nav-text">静态文件配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E7%BB%A7%E6%89%BF"><span class="nav-number">3.4.</span> <span class="nav-text">模板继承</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Model"><span class="nav-number">4.</span> <span class="nav-text">Model</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9E%8B"><span class="nav-number">4.1.</span> <span class="nav-text">定义模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="nav-number">4.2.</span> <span class="nav-text">数据库操作</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A1%A8%E5%8D%95"><span class="nav-number">5.</span> <span class="nav-text">表单</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%86%E5%9B%BEviews"><span class="nav-number">6.</span> <span class="nav-text">视图views</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1"><span class="nav-number">7.</span> <span class="nav-text">路由</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Admin%E7%AE%A1%E7%90%86"><span class="nav-number">8.</span> <span class="nav-text">Admin管理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A1%A8%E7%9A%84%E5%AE%9E%E4%BE%8B"><span class="nav-number">9.</span> <span class="nav-text">表的实例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E4%B8%AA%E8%A1%A8"><span class="nav-number">9.1.</span> <span class="nav-text">单个表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E4%B8%AA%E8%A1%A8"><span class="nav-number">9.2.</span> <span class="nav-text">多个表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81%EF%BC%88Auth%EF%BC%89%E7%BB%84%E4%BB%B6"><span class="nav-number">10.</span> <span class="nav-text">用户认证（Auth）组件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">11.</span> <span class="nav-text">参考</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Thomas-Li"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Thomas-Li</p>
  <div class="site-description" itemprop="description">Stay hungry. Stay foolish.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">183</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">37</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/thomas-li-sjtu" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;thomas-li-sjtu" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/thomasli2017" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;thomasli2017" rel="noopener" target="_blank"><i class="fa fa-csdn fa-fw"></i>CSDN</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://rooki3ray.github.io/" title="https:&#x2F;&#x2F;rooki3ray.github.io&#x2F;" rel="noopener" target="_blank">rooki3ray</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://entropy2333.github.io/" title="https:&#x2F;&#x2F;entropy2333.github.io&#x2F;" rel="noopener" target="_blank">entropy2333</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://schenk75.github.io/" title="https:&#x2F;&#x2F;schenk75.github.io&#x2F;" rel="noopener" target="_blank">Schenk75</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://ainevsia.github.io/" title="https:&#x2F;&#x2F;ainevsia.github.io&#x2F;" rel="noopener" target="_blank">Ainevsia</a>
        </li>
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Thomas-Li</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">1.7m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">25:04</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  
<div class="moon-menu">
  <div class="moon-menu-items">
    
    <div class="moon-menu-item" onclick="back2bottom()">
      <i class='fa fa-chevron-down'></i>    </div>
    
    <div class="moon-menu-item" onclick="back2top()">
      <i class='fa fa-chevron-up'></i>    </div>
    
  </div>
  <div class="moon-menu-button" onclick="moonMenuClick()">
    <svg class="moon-menu-svg">
      <circle class="moon-menu-cricle" cx="50%" cy="50%" r="44%"></circle>
      <circle class="moon-menu-border" cx="50%" cy="50%" r="48%"></circle>
      <g class="moon-menu-points">
        <circle class="moon-menu-point" r=".2rem" cx="0" cy="-.8rem"></circle>
        <circle class="moon-menu-point" r=".2rem"></circle>
        <circle class="moon-menu-point" r=".2rem" cx="0" cy=".8rem"></circle>
      </g>
    </svg>
    <div class="moon-menu-icon">
    </div>
    <div class="moon-menu-text">
    </div>
  </div>
</div>
<script src="/js/injector.js"></script>

  
    <script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
  
</body>
</html>
